2025-12-12 13:00:05.69
fe3ac96f
User
`);c.write(s.format.apply(s,S))}}w(x,"warn"),Object.defineProperty(e.exports,"isWin",{get:w(function(){return o},"get"),set:w(function(N){o=N},"set")}),e.exports.warnTo=function(N){var S=c;return c=N,S},e.exports.getFileName=function(N){var S=N||je.env,I=S.PGPASSFILE||(o?t.join(S.APPDATA||"./","postgresql","pgpass.conf"):t.join(S.HOME||"./",".pgpass"));return I},e.exports.usePgPass=function(N,S){return Object.prototype.hasOwnProperty.call(je.env,"PGPASSWORD")?!1:o?!0:(S=S||"",h(N.mode)?N.mode&(u|l)?(x('WARNING: password file "%s" has group or world access; permissions should be u=rw (0600) or less',S),!1):!0:(x('WARNING: password file "%s" is not a plain file',S),!1))};var _=e.exports.match=function(N,S){return g.slice(0,-1).reduce(function(I,T,A){return A==1&&Number(N[T]||a)===Number(S[T])?I&&!0:I&&(S[T]==="*"||S[T]===N[T])},!0)};e.exports.getPassword=function(N,S,I){var T,A=S.pipe(i());function L(X){var F=E(X);F&&j(F)&&_(N,F)&&(T=F[y],A.end())}w(L,"onLine");var B=w(function(){S.destroy(),I(T)},"onEnd"),ee=w(function(X){S.destroy(),x("WARNING: error on reading file: %s",X),I(void 0)},"onErr");S.on("error",ee),A.on("data",L).on("end",B).on("error",ee)};var E=e.exports.parseLine=function(N){if(N.length<11||N.match(/^\s+#/))return null;for(var S="",I="",T=0,A=0,L=0,B={},ee=!1,X=w(function(G,ue,ve){var Re=N.substring(ue,ve);Object.hasOwnProperty.call(je.env,"PGPASS_NO_DEESCAPE")||(Re=Re.replace(/\\([:\\])/g,"$1")),B[g[G]]=Re},"addToObj"),F=0;F=0&&S==":"&&I!=="\\"&&(X(T,A,F+1),A=F+2,T+=1)}return B=Object.keys(B).length===f?B:null,B},j=e.exports.isValidEntry=function(N){for(var S={0:function(B){return B.length>0},1:function(B){return B==="*"?!0:(B=Number(B),isFinite(B)&&B>0&&B<9007199254740992&&Math.floor(B)===B)},2:function(B){return B.length>0},3:function(B){return B.length>0},4:function(B){return B.length>0}},I=0;I{"use strict";ge();var t=(A8(),Gt(e0)),n=(P8(),Gt(t0)),i=MV();e.exports=function(s,a){var o=i.getFileName();n.stat(o,function(c,u){if(c||!i.usePgPass(u,o))return a(void 0);var l=n.createReadStream(o);i.getPassword(s,l,a)})},e.exports.warnTo=i.warnTo}),n0=Oe((r,e)=>{"use strict";ge();var t=zf();function n(i){this._types=i||t,this.text={},this.binary={}}w(n,"TypeOverrides"),n.prototype.getOverrides=function(i){switch(i){case"text":return this.text;case"binary":return this.binary;default:return{}}},n.prototype.setTypeParser=function(i,s,a){typeof s=="function"&&(a=s,s="text"),this.getOverrides(s)[i]=a},n.prototype.getTypeParser=function(i,s){return s=s||"text",this.getOverrides(s)[i]||this._types.getTypeParser(i,s)},e.exports=n}),R8={};vn(R8,{default:()=>N8});BV=Or(()=>{"use strict";ge(),N8={}}),D8={};vn(D8,{parse:()=>i0});M8=Or(()=>{"use strict";ge(),w(i0,"parse")}),FV=Oe((r,e)=>{"use strict";ge();var t=(M8(),Gt(D8)),n=(P8(),Gt(t0));function i(s){if(s.charAt(0)==="/"){var o=s.split(" ");return{host:o[0],database:o[1]}}var a=t.parse(/ |%[^a-f0-9]|%[a-f0-9][^a-f0-9]/i.test(s)?encodeURI(s).replace(/\%25(\d\d)/g,"%$1"):s,!0),o=a.query;for(var c in o)Array.isArray(o[c])&&(o[c]=o[c][o[c].length-1]);var u=(a.auth||":").split(":");if(o.user=u[0],o.password=u.splice(1).join(":"),o.port=a.port,a.protocol=="socket:")return o.host=decodeURI(a.pathname),o.database=a.query.db,o.client_encoding=a.query.encoding,o;o.host||(o.host=a.hostname);var l=a.pathname;if(!o.host&&l&&/^%2f/i.test(l)){var p=l.split("/");o.host=decodeURIComponent(p[0]),l=p.splice(1).join("/")}switch(l&&l.charAt(0)==="/"&&(l=l.slice(1)||null),o.database=l&&decodeURI(l),(o.ssl==="true"||o.ssl==="1")&&(o.ssl=!0),o.ssl==="0"&&(o.ssl=!1),(o.sslcert||o.sslkey||o.sslrootcert||o.sslmode)&&(o.ssl={}),o.sslcert&&(o.ssl.cert=n.readFileSync(o.sslcert).toString()),o.sslkey&&(o.ssl.key=n.readFileSync(o.sslkey).toString()),o.sslrootcert&&(o.ssl.ca=n.readFileSync(o.sslrootcert).toString()),o.sslmode){case"disable":{o.ssl=!1;break}case"prefer":case"require":case"verify-ca":case"verify-full":break;case"no-verify":{o.ssl.rejectUnauthorized=!1;break}}return o}w(i,"parse"),e.exports=i,i.parse=i}),s0=Oe((r,e)=>{"use strict";ge();var t=(BV(),Gt(R8)),n=Qf(),i=FV().parse,s=w(function(p,d,h){return h===void 0?h=je.env["PG"+p.toUpperCase()]:h===!1||(h=je.env[h]),d[p]||h||n[p]},"val"),a=w(function(){switch(je.env.PGSSLMODE){case"disable":return!1;case"prefer":case"require":case"verify-ca":case"verify-full":return!0;case"no-verify":return{rejectUnauthorized:!1}}return n.ssl},"readSSLConfigFromEnvironment"),o=w(function(p){return"'"+(""+p).replace(/\\/g,"\\\\").replace(/'/g,"\\'")+"'"},"quoteParamValue"),c=w(function(p,d,h){var g=d[h];g!=null&&p.push(h+"="+o(g))},"add"),u=class{constructor(d){d=typeof d=="string"?i(d):d||{},d.connectionString&&(d=Object.assign({},d,i(d.connectionString))),this.user=s("user",d),this.database=s("database",d),this.database===void 0&&(this.database=this.user),this.port=parseInt(s("port",d),10),this.host=s("host",d),Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:s("password",d)}),this.binary=s("binary",d),this.options=s("options",d),this.ssl=typeof d.ssl>"u"?a():d.ssl,typeof this.ssl=="string"&&this.ssl==="true"&&(this.ssl=!0),this.ssl==="no-verify"&&(this.ssl={rejectUnauthorized:!1}),this.ssl&&this.ssl.key&&Object.defineProperty(this.ssl,"key",{enumerable:!1}),this.client_encoding=s("client_encoding",d),this.replication=s("replication",d),this.isDomainSocket=!(this.host||"").indexOf("/"),this.application_name=s("application_name",d,"PGAPPNAME"),this.fallback_application_name=s("fallback_application_name",d,!1),this.statement_timeout=s("statement_timeout",d,!1),this.lock_timeout=s("lock_timeout",d,!1),this.idle_in_transaction_session_timeout=s("idle_in_transaction_session_timeout",d,!1),this.query_timeout=s("query_timeout",d,!1),d.connectionTimeoutMillis===void 0?this.connect_timeout=je.env.PGCONNECT_TIMEOUT||0:this.connect_timeout=Math.floor(d.connectionTimeoutMillis/1e3),d.keepAlive===!1?this.keepalives=0:d.keepAlive===!0&&(this.keepalives=1),typeof d.keepAliveInitialDelayMillis=="number"&&(this.keepalives_idle=Math.floor(d.keepAliveInitialDelayMillis/1e3))}getLibpqConnectionString(d){var h=[];c(h,this,"user"),c(h,this,"password"),c(h,this,"port"),c(h,this,"application_name"),c(h,this,"fallback_application_name"),c(h,this,"connect_timeout"),c(h,this,"options");var g=typeof this.ssl=="object"?this.ssl:this.ssl?{sslmode:this.ssl}:{};if(c(h,g,"sslmode"),c(h,g,"sslca"),c(h,g,"sslkey"),c(h,g,"sslcert"),c(h,g,"sslrootcert"),this.database&&h.push("dbname="+o(this.database)),this.replication&&h.push("replication="+o(this.replication)),this.host&&h.push("host="+o(this.host)),this.isDomainSocket)return d(null,h.join(" "));this.client_encoding&&h.push("client_encoding="+o(this.client_encoding)),t.lookup(this.host,function(f,y){return f?d(f,null):(h.push("hostaddr="+o(y)),d(null,h.join(" ")))})}};w(u,"ConnectionParameters");var l=u;e.exports=l}),qV=Oe((r,e)=>{"use strict";ge();var t=zf(),n=/^([A-Za-z]+)(?: (\d+))?(?: (\d+))?/,i=class{constructor(o,c){this.command=null,this.rowCount=null,this.oid=null,this.rows=[],this.fields=[],this._parsers=void 0,this._types=c,this.RowCtor=null,this.rowAsArray=o==="array",this.rowAsArray&&(this.parseRow=this._parseRowAsArray)}addCommandComplete(o){var c;o.text?c=n.exec(o.text):c=n.exec(o.command),c&&(this.command=c[1],c[3]?(this.oid=parseInt(c[2],10),this.rowCount=parseInt(c[3],10)):c[2]&&(this.rowCount=parseInt(c[2],10)))}_parseRowAsArray(o){for(var c=new Array(o.length),u=0,l=o.length;u{"use strict";ge();var{EventEmitter:t}=aa(),n=qV(),i=Wf(),s=class extends t{constructor(c,u,l){super(),c=i.normalizeQueryConfig(c,u,l),this.text=c.text,this.values=c.values,this.rows=c.rows,this.types=c.types,this.name=c.name,this.binary=c.binary,this.portal=c.portal||"",this.callback=c.callback,this._rowMode=c.rowMode,je.domain&&c.callback&&(this.callback=je.domain.bind(c.callback)),this._result=new n(this._rowMode,this.types),this._results=this._result,this.isPreparedStatement=!1,this._canceledDueToError=!1,this._promise=null}requiresPreparation(){return this.name||this.rows?!0:!this.text||!this.values?!1:this.values.length>0}_checkForMultirow(){this._result.command&&(Array.isArray(this._results)||(this._results=[this._result]),this._result=new n(this._rowMode,this.types),this._results.push(this._result))}handleRowDescription(c){this._checkForMultirow(),this._result.addFields(c.fields),this._accumulateRows=this.callback||!this.listeners("row").length}handleDataRow(c){let u;if(!this._canceledDueToError){try{u=this._result.parseRow(c.fields)}catch(l){this._canceledDueToError=l;return}this.emit("row",u,this._result),this._accumulateRows&&this._result.addRow(u)}}handleCommandComplete(c,u){this._checkForMultirow(),this._result.addCommandComplete(c),this.rows&&u.sync()}handleEmptyQuery(c){this.rows&&c.sync()}handleError(c,u){if(this._canceledDueToError&&(c=this._canceledDueToError,this._canceledDueToError=!1),this.callback)return this.callback(c);this.emit("error",c)}handleReadyForQuery(c){if(this._canceledDueToError)return this.handleError(this._canceledDueToError,c);if(this.callback)try{this.callback(null,this._results)}catch(u){je.nextTick(()=>{throw u})}this.emit("end",this._results)}submit(c){if(typeof this.text!="string"&&typeof this.name!="string")return new Error("A query must have either text or a name. Supplying neither is unsupported.");let u=c.parsedStatements[this.name];return this.text&&u&&this.text!==u?new Error(`Prepared statements must be unique - '${this.name}' was used for a different statement`):this.values&&!Array.isArray(this.values)?new Error("Query values must be an array"):(this.requiresPreparation()?this.prepare(c):c.query(this.text),null)}hasBeenParsed(c){return this.name&&c.parsedStatements[this.name]}handlePortalSuspended(c){this._getRows(c,this.rows)}_getRows(c,u){c.execute({portal:this.portal,rows:u}),u?c.flush():c.sync()}prepare(c){this.isPreparedStatement=!0,this.hasBeenParsed(c)||c.parse({text:this.text,name:this.name,types:this.types});try{c.bind({portal:this.portal,statement:this.name,values:this.values,binary:this.binary,valueMapper:i.prepareValue})}catch(u){this.handleError(u,c);return}c.describe({type:"P",name:this.portal||""}),this._getRows(c,this.rows)}handleCopyInResponse(c){c.sendCopyFail("No source stream defined")}handleCopyData(c,u){}};w(s,"Query");var a=s;e.exports=a}),L8={};vn(L8,{Socket:()=>Yi,isIP:()=>B8});a0=Or(()=>{"use strict";ge(),f8=Uo(aa(),1),w(B8,"isIP"),Kx=/^[^.]+\./,Tl=class xe extends f8.EventEmitter{constructor(){super(...arguments),Ae(this,"opts",{}),Ae(this,"connecting",!1),Ae(this,"pending",!0),Ae(this,"writable",!0),Ae(this,"encrypted",!1),Ae(this,"authorized",!1),Ae(this,"destroyed",!1),Ae(this,"ws",null),Ae(this,"writeBuffer"),Ae(this,"tlsState",0),Ae(this,"tlsRead"),Ae(this,"tlsWrite")}static get poolQueryViaFetch(){return xe.opts.poolQueryViaFetch??xe.defaults.poolQueryViaFetch}static set poolQueryViaFetch(e){xe.opts.poolQueryViaFetch=e}static get fetchEndpoint(){return xe.opts.fetchEndpoint??xe.defaults.fetchEndpoint}static set fetchEndpoint(e){xe.opts.fetchEndpoint=e}static get fetchConnectionCache(){return!0}static set fetchConnectionCache(e){console.warn("The `fetchConnectionCache` option is deprecated (now always `true`)")}static get fetchFunction(){return xe.opts.fetchFunction??xe.defaults.fetchFunction}static set fetchFunction(e){xe.opts.fetchFunction=e}static get webSocketConstructor(){return xe.opts.webSocketConstructor??xe.defaults.webSocketConstructor}static set webSocketConstructor(e){xe.opts.webSocketConstructor=e}get webSocketConstructor(){return this.opts.webSocketConstructor??xe.webSocketConstructor}set webSocketConstructor(e){this.opts.webSocketConstructor=e}static get wsProxy(){return xe.opts.wsProxy??xe.defaults.wsProxy}static set wsProxy(e){xe.opts.wsProxy=e}get wsProxy(){return this.opts.wsProxy??xe.wsProxy}set wsProxy(e){this.opts.wsProxy=e}static get coalesceWrites(){return xe.opts.coalesceWrites??xe.defaults.coalesceWrites}static set coalesceWrites(e){xe.opts.coalesceWrites=e}get coalesceWrites(){return this.opts.coalesceWrites??xe.coalesceWrites}set coalesceWrites(e){this.opts.coalesceWrites=e}static get useSecureWebSocket(){return xe.opts.useSecureWebSocket??xe.defaults.useSecureWebSocket}static set useSecureWebSocket(e){xe.opts.useSecureWebSocket=e}get useSecureWebSocket(){return this.opts.useSecureWebSocket??xe.useSecureWebSocket}set useSecureWebSocket(e){this.opts.useSecureWebSocket=e}static get forceDisablePgSSL(){return xe.opts.forceDisablePgSSL??xe.defaults.forceDisablePgSSL}static set forceDisablePgSSL(e){xe.opts.forceDisablePgSSL=e}get forceDisablePgSSL(){return this.opts.forceDisablePgSSL??xe.forceDisablePgSSL}set forceDisablePgSSL(e){this.opts.forceDisablePgSSL=e}static get disableSNI(){return xe.opts.disableSNI??xe.defaults.disableSNI}static set disableSNI(e){xe.opts.disableSNI=e}get disableSNI(){return this.opts.disableSNI??xe.disableSNI}set disableSNI(e){this.opts.disableSNI=e}static get pipelineConnect(){return xe.opts.pipelineConnect??xe.defaults.pipelineConnect}static set pipelineConnect(e){xe.opts.pipelineConnect=e}get pipelineConnect(){return this.opts.pipelineConnect??xe.pipelineConnect}set pipelineConnect(e){this.opts.pipelineConnect=e}static get subtls(){return xe.opts.subtls??xe.defaults.subtls}static set subtls(e){xe.opts.subtls=e}get subtls(){return this.opts.subtls??xe.subtls}set subtls(e){this.opts.subtls=e}static get pipelineTLS(){return xe.opts.pipelineTLS??xe.defaults.pipelineTLS}static set pipelineTLS(e){xe.opts.pipelineTLS=e}get pipelineTLS(){return this.opts.pipelineTLS??xe.pipelineTLS}set pipelineTLS(e){this.opts.pipelineTLS=e}static get rootCerts(){return xe.opts.rootCerts??xe.defaults.rootCerts}static set rootCerts(e){xe.opts.rootCerts=e}get rootCerts(){return this.opts.rootCerts??xe.rootCerts}set rootCerts(e){this.opts.rootCerts=e}wsProxyAddrForHost(e,t){let n=this.wsProxy;if(n===void 0)throw new Error("No WebSocket proxy is configured. Please see https://github.com/neondatabase/serverless/blob/main/CONFIG.md#wsproxy-string--host-string-port-number--string--string");return typeof n=="function"?n(e,t):`${n}?address=${e}:${t}`}setNoDelay(){return this}setKeepAlive(){return this}ref(){return this}unref(){return this}connect(e,t,n){this.connecting=!0,n&&this.once("connect",n);let i=w(()=>{this.connecting=!1,this.pending=!1,this.emit("connect"),this.emit("ready")},"handleWebSocketOpen"),s=w((o,c=!1)=>{o.binaryType="arraybuffer",o.addEventListener("error",u=>{this.emit("error",u),this.emit("close")}),o.addEventListener("message",u=>{if(this.tlsState===0){let l=Ce.from(u.data);this.emit("data",l)}}),o.addEventListener("close",()=>{this.emit("close")}),c?i():o.addEventListener("open",i)},"configureWebSocket"),a;try{a=this.wsProxyAddrForHost(t,typeof e=="string"?parseInt(e,10):e)}catch(o){this.emit("error",o),this.emit("close");return}try{let o=(this.useSecureWebSocket?"wss:":"ws:")+"//"+a;if(this.webSocketConstructor!==void 0)this.ws=new this.webSocketConstructor(o),s(this.ws);else try{this.ws=new WebSocket(o),s(this.ws)}catch{this.ws=new __unstable_WebSocket(o),s(this.ws)}}catch(o){let c=(this.useSecureWebSocket?"https:":"http:")+"//"+a;fetch(c,{headers:{Upgrade:"websocket"}}).then(u=>{if(this.ws=u.webSocket,this.ws==null)throw o;this.ws.accept(),s(this.ws,!0)}).catch(u=>{this.emit("error",new Error(`All attempts to open a WebSocket to connect to the database failed. Please refer to https://github.com/neondatabase/serverless/blob/main/CONFIG.md#websocketconstructor-typeof-websocket--undefined. Details: ${u.message}`)),this.emit("close")})}}async startTls(e){if(this.subtls===void 0)throw new Error("For Postgres SSL connections, you must set `neonConfig.subtls` to the subtls library. See https://github.com/neondatabase/serverless/blob/main/CONFIG.md for more information.");this.tlsState=1;let t=this.subtls.TrustedCert.fromPEM(this.rootCerts),n=new this.subtls.WebSocketReadQueue(this.ws),i=n.read.bind(n),s=this.rawWrite.bind(this),[a,o]=await this.subtls.startTls(e,t,i,s,{useSNI:!this.disableSNI,expectPreData:this.pipelineTLS?new Uint8Array([83]):void 0});this.tlsRead=a,this.tlsWrite=o,this.tlsState=2,this.encrypted=!0,this.authorized=!0,this.emit("secureConnection",this),this.tlsReadLoop()}async tlsReadLoop(){for(;;){let e=await this.tlsRead();if(e===void 0)break;{let t=Ce.from(e);this.emit("data",t)}}}rawWrite(e){if(!this.coalesceWrites){this.ws.send(e);return}if(this.writeBuffer===void 0)this.writeBuffer=e,setTimeout(()=>{this.ws.send(this.writeBuffer),this.writeBuffer=void 0},0);else{let t=new Uint8Array(this.writeBuffer.length+e.length);t.set(this.writeBuffer),t.set(e,this.writeBuffer.length),this.writeBuffer=t}}write(e,t="utf8",n=i=>{}){return e.length===0?(n(),!0):(typeof e=="string"&&(e=Ce.from(e,t)),this.tlsState===0?(this.rawWrite(e),n()):this.tlsState===1?this.once("secureConnection",()=>{this.write(e,t,n)}):(this.tlsWrite(e),n()),!0)}end(e=Ce.alloc(0),t="utf8",n=()=>{}){return this.write(e,t,()=>{this.ws.close(),n()}),this}destroy(){return this.destroyed=!0,this.end()}},w(Tl,"Socket"),Ae(Tl,"defaults",{poolQueryViaFetch:!1,fetchEndpoint:w((r,e,t)=>{let n;return t?.jwtAuth?n=r.replace(Kx,"apiauth."):n=r.replace(Kx,"api."),"https://"+n+"/sql"},"fetchEndpoint"),fetchConnectionCache:!0,fetchFunction:void 0,webSocketConstructor:void 0,wsProxy:w(r=>r+"/v2","wsProxy"),useSecureWebSocket:!0,forceDisablePgSSL:!0,coalesceWrites:!0,pipelineConnect:"password",subtls:void 0,rootCerts:"",pipelineTLS:!1,disableSNI:!1}),Ae(Tl,"opts",{}),Yi=Tl}),F8=Oe(r=>{"use strict";ge(),Object.defineProperty(r,"__esModule",{value:!0}),r.NoticeMessage=r.DataRowMessage=r.CommandCompleteMessage=r.ReadyForQueryMessage=r.NotificationResponseMessage=r.BackendKeyDataMessage=r.AuthenticationMD5Password=r.ParameterStatusMessage=r.ParameterDescriptionMessage=r.RowDescriptionMessage=r.Field=r.CopyResponse=r.CopyDataMessage=r.DatabaseError=r.copyDone=r.emptyQuery=r.replicationStart=r.portalSuspended=r.noData=r.closeComplete=r.bindComplete=r.parseComplete=void 0,r.parseComplete={name:"parseComplete",length:5},r.bindComplete={name:"bindComplete",length:5},r.closeComplete={name:"closeComplete",length:5},r.noData={name:"noData",length:5},r.portalSuspended={name:"portalSuspended",length:5},r.replicationStart={name:"replicationStart",length:4},r.emptyQuery={name:"emptyQuery",length:4},r.copyDone={name:"copyDone",length:4};var e=class extends Error{constructor(F,G,ue){super(F),this.length=G,this.name=ue}};w(e,"DatabaseError");var t=e;r.DatabaseError=t;var n=class{constructor(F,G){this.length=F,this.chunk=G,this.name="copyData"}};w(n,"CopyDataMessage");var i=n;r.CopyDataMessage=i;var s=class{constructor(F,G,ue,ve){this.length=F,this.name=G,this.binary=ue,this.columnTypes=new Array(ve)}};w(s,"CopyResponse");var a=s;r.CopyResponse=a;var o=class{constructor(F,G,ue,ve,Re,Be,ut){this.name=F,this.tableID=G,this.columnID=ue,this.dataTypeID=ve,this.dataTypeSize=Re,this.dataTypeModifier=Be,this.format=ut}};w(o,"Field");var c=o;r.Field=c;var u=class{constructor(F,G){this.length=F,this.fieldCount=G,this.name="rowDescription",this.fields=new Array(this.fieldCount)}};w(u,"RowDescriptionMessage");var l=u;r.RowDescriptionMessage=l;var p=class{constructor(F,G){this.length=F,this.parameterCount=G,this.name="parameterDescription",this.dataTypeIDs=new Array(this.parameterCount)}};w(p,"ParameterDescriptionMessage");var d=p;r.ParameterDescriptionMessage=d;var h=class{constructor(F,G,ue){this.length=F,this.parameterName=G,this.parameterValue=ue,this.name="parameterStatus"}};w(h,"ParameterStatusMessage");var g=h;r.ParameterStatusMessage=g;var f=class{constructor(F,G){this.length=F,this.salt=G,this.name="authenticationMD5Password"}};w(f,"AuthenticationMD5Password");var y=f;r.AuthenticationMD5Password=y;var x=class{constructor(F,G,ue){this.length=F,this.processID=G,this.secretKey=ue,this.name="backendKeyData"}};w(x,"BackendKeyDataMessage");var _=x;r.BackendKeyDataMessage=_;var E=class{constructor(F,G,ue,ve){this.length=F,this.processId=G,this.channel=ue,this.payload=ve,this.name="notification"}};w(E,"NotificationResponseMessage");var j=E;r.NotificationResponseMessage=j;var N=class{constructor(F,G){this.length=F,this.status=G,this.name="readyForQuery"}};w(N,"ReadyForQueryMessage");var S=N;r.ReadyForQueryMessage=S;var I=class{constructor(F,G){this.length=F,this.text=G,this.name="commandComplete"}};w(I,"CommandCompleteMessage");var T=I;r.CommandCompleteMessage=T;var A=class{constructor(F,G){this.length=F,this.fields=G,this.name="dataRow",this.fieldCount=G.length}};w(A,"DataRowMessage");var L=A;r.DataRowMessage=L;var B=class{constructor(F,G){this.length=F,this.message=G,this.name="notice"}};w(B,"NoticeMessage");var ee=B;r.NoticeMessage=ee}),UV=Oe(r=>{"use strict";ge(),Object.defineProperty(r,"__esModule",{value:!0}),r.Writer=void 0;var e=class{constructor(i=256){this.size=i,this.offset=5,this.headerPosition=0,this.buffer=Ce.allocUnsafe(i)}ensure(i){var s=this.buffer.length-this.offset;if(s>1)+i;this.buffer=Ce.allocUnsafe(o),a.copy(this.buffer)}}addInt32(i){return this.ensure(4),this.buffer[this.offset++]=i>>>24&255,this.buffer[this.offset++]=i>>>16&255,this.buffer[this.offset++]=i>>>8&255,this.buffer[this.offset++]=i>>>0&255,this}addInt16(i){return this.ensure(2),this.buffer[this.offset++]=i>>>8&255,this.buffer[this.offset++]=i>>>0&255,this}addCString(i){if(!i)this.ensure(1);else{var s=Ce.byteLength(i);this.ensure(s+1),this.buffer.write(i,this.offset,"utf-8"),this.offset+=s}return this.buffer[this.offset++]=0,this}addString(i=""){var s=Ce.byteLength(i);return this.ensure(s),this.buffer.write(i,this.offset),this.offset+=s,this}add(i){return this.ensure(i.length),i.copy(this.buffer,this.offset),this.offset+=i.length,this}join(i){if(i){this.buffer[this.headerPosition]=i;let s=this.offset-(this.headerPosition+1);this.buffer.writeInt32BE(s,this.headerPosition+1)}return this.buffer.slice(i?0:5,this.offset)}flush(i){var s=this.join(i);return this.offset=5,this.headerPosition=0,this.buffer=Ce.allocUnsafe(this.size),s}};w(e,"Writer");var t=e;r.Writer=t}),zV=Oe(r=>{"use strict";ge(),Object.defineProperty(r,"__esModule",{value:!0}),r.serialize=void 0;var e=UV(),t=new e.Writer,n=w(F=>{t.addInt16(3).addInt16(0);for(let ve of Object.keys(F))t.addCString(ve).addCString(F[ve]);t.addCString("client_encoding").addCString("UTF8");var G=t.addCString("").flush(),ue=G.length+4;return new e.Writer().addInt32(ue).add(G).flush()},"startup"),i=w(()=>{let F=Ce.allocUnsafe(8);return F.writeInt32BE(8,0),F.writeInt32BE(80877103,4),F},"requestSsl"),s=w(F=>t.addCString(F).flush(112),"password"),a=w(function(F,G){return t.addCString(F).addInt32(Ce.byteLength(G)).addString(G),t.flush(112)},"sendSASLInitialResponseMessage"),o=w(function(F){return t.addString(F).flush(112)},"sendSCRAMClientFinalMessage"),c=w(F=>t.addCString(F).flush(81),"query"),u=[],l=w(F=>{let G=F.name||"";G.length>63&&(console.error("Warning! Postgres only supports 63 characters for query names."),console.error("You supplied %s (%s)",G,G.length),console.error("This can cause conflicts and silent errors executing queries"));let ue=F.types||u;for(var ve=ue.length,Re=t.addCString(G).addCString(F.text).addInt16(ve),Be=0;Be{let G=F.portal||"",ue=F.statement||"",ve=F.binary||!1,Re=F.values||u,Be=Re.length;return t.addCString(G).addCString(ue),t.addInt16(Be),d(Re,F.valueMapper),t.addInt16(Be),t.add(p.flush()),t.addInt16(ve?1:0),t.flush(66)},"bind"),g=Ce.from([69,0,0,0,9,0,0,0,0,0]),f=w(F=>{if(!F||!F.portal&&!F.rows)return g;let G=F.portal||"",ue=F.rows||0,ve=Ce.byteLength(G),Re=4+ve+1+4,Be=Ce.allocUnsafe(1+Re);return Be[0]=69,Be.writeInt32BE(Re,1),Be.write(G,5,"utf-8"),Be[ve+5]=0,Be.writeUInt32BE(ue,Be.length-4),Be},"execute"),y=w((F,G)=>{let ue=Ce.allocUnsafe(16);return ue.writeInt32BE(16,0),ue.writeInt16BE(1234,4),ue.writeInt16BE(5678,6),ue.writeInt32BE(F,8),ue.writeInt32BE(G,12),ue},"cancel"),x=w((F,G)=>{let ue=4+Ce.byteLength(G)+1,ve=Ce.allocUnsafe(1+ue);return ve[0]=F,ve.writeInt32BE(ue,1),ve.write(G,5,"utf-8"),ve[ue]=0,ve},"cstringMessage"),_=t.addCString("P").flush(68),E=t.addCString("S").flush(68),j=w(F=>F.name?x(68,`${F.type}${F.name||""}`):F.type==="P"?_:E,"describe"),N=w(F=>{let G=`${F.type}${F.name||""}`;return x(67,G)},"close"),S=w(F=>t.add(F).flush(100),"copyData"),I=w(F=>x(102,F),"copyFail"),T=w(F=>Ce.from([F,0,0,0,4]),"codeOnlyBuffer"),A=T(72),L=T(83),B=T(88),ee=T(99),X={startup:n,password:s,requestSsl:i,sendSASLInitialResponseMessage:a,sendSCRAMClientFinalMessage:o,query:c,parse:l,bind:h,execute:f,describe:j,close:N,flush:w(()=>A,"flush"),sync:w(()=>L,"sync"),end:w(()=>B,"end"),copyData:S,copyDone:w(()=>ee,"copyDone"),copyFail:I,cancel:y};r.serialize=X}),QV=Oe(r=>{"use strict";ge(),Object.defineProperty(r,"__esModule",{value:!0}),r.BufferReader=void 0;var e=Ce.allocUnsafe(0),t=class{constructor(s=0){this.offset=s,this.buffer=e,this.encoding="utf-8"}setBuffer(s,a){this.offset=s,this.buffer=a}int16(){let s=this.buffer.readInt16BE(this.offset);return this.offset+=2,s}byte(){let s=this.buffer[this.offset];return this.offset++,s}int32(){let s=this.buffer.readInt32BE(this.offset);return this.offset+=4,s}string(s){let a=this.buffer.toString(this.encoding,this.offset,this.offset+s);return this.offset+=s,a}cstring(){let s=this.offset,a=s;for(;this.buffer[a++]!==0;);return this.offset=a,this.buffer.toString(this.encoding,s,a-1)}bytes(s){let a=this.buffer.slice(this.offset,this.offset+s);return this.offset+=s,a}};w(t,"BufferReader");var n=t;r.BufferReader=n}),WV=Oe(r=>{"use strict";ge(),Object.defineProperty(r,"__esModule",{value:!0}),r.Parser=void 0;var e=F8(),t=QV(),n=1,i=4,s=n+i,a=Ce.allocUnsafe(0),o=class{constructor(l){if(this.buffer=a,this.bufferLength=0,this.bufferOffset=0,this.reader=new t.BufferReader,l?.mode==="binary")throw new Error("Binary mode not supported yet");this.mode=l?.mode||"text"}parse(l,p){this.mergeBuffer(l);let d=this.bufferOffset+this.bufferLength,h=this.bufferOffset;for(;h+s<=d;){let g=this.buffer[h],f=this.buffer.readUInt32BE(h+n),y=n+f;if(y+h<=d){let x=this.handlePacket(h+s,g,f,this.buffer);p(x),h+=y}else break}h===d?(this.buffer=a,this.bufferLength=0,this.bufferOffset=0):(this.bufferLength=d-h,this.bufferOffset=h)}mergeBuffer(l){if(this.bufferLength>0){let p=this.bufferLength+l.byteLength;if(p+this.bufferOffset>this.buffer.byteLength){let d;if(p<=this.buffer.byteLength&&this.bufferOffset>=this.bufferLength)d=this.buffer;else{let h=this.buffer.byteLength*2;for(;p>=h;)h*=2;d=Ce.allocUnsafe(h)}this.buffer.copy(d,0,this.bufferOffset,this.bufferOffset+this.bufferLength),this.buffer=d,this.bufferOffset=0}l.copy(this.buffer,this.bufferOffset+this.bufferLength),this.bufferLength=p}else this.buffer=l,this.bufferOffset=0,this.bufferLength=l.byteLength}handlePacket(l,p,d,h){switch(p){case 50:return e.bindComplete;case 49:return e.parseComplete;case 51:return e.closeComplete;case 110:return e.noData;case 115:return e.portalSuspended;case 99:return e.copyDone;case 87:return e.replicationStart;case 73:return e.emptyQuery;case 68:return this.parseDataRowMessage(l,d,h);case 67:return this.parseCommandCompleteMessage(l,d,h);case 90:return this.parseReadyForQueryMessage(l,d,h);case 65:return this.parseNotificationMessage(l,d,h);case 82:return this.parseAuthenticationResponse(l,d,h);case 83:return this.parseParameterStatusMessage(l,d,h);case 75:return this.parseBackendKeyData(l,d,h);case 69:return this.parseErrorMessage(l,d,h,"error");case 78:return this.parseErrorMessage(l,d,h,"notice");case 84:return this.parseRowDescriptionMessage(l,d,h);case 116:return this.parseParameterDescriptionMessage(l,d,h);case 71:return this.parseCopyInMessage(l,d,h);case 72:return this.parseCopyOutMessage(l,d,h);case 100:return this.parseCopyData(l,d,h);default:return new e.DatabaseError("received invalid response: "+p.toString(16),d,"error")}}parseReadyForQueryMessage(l,p,d){this.reader.setBuffer(l,d);let h=this.reader.string(1);return new e.ReadyForQueryMessage(p,h)}parseCommandCompleteMessage(l,p,d){this.reader.setBuffer(l,d);let h=this.reader.cstring();return new e.CommandCompleteMessage(p,h)}parseCopyData(l,p,d){let h=d.slice(l,l+(p-4));return new e.CopyDataMessage(p,h)}parseCopyInMessage(l,p,d){return this.parseCopyMessage(l,p,d,"copyInResponse")}parseCopyOutMessage(l,p,d){return this.parseCopyMessage(l,p,d,"copyOutResponse")}parseCopyMessage(l,p,d,h){this.reader.setBuffer(l,d);let g=this.reader.byte()!==0,f=this.reader.int16(),y=new e.CopyResponse(p,h,g,f);for(let x=0;x{"use strict";ge(),Object.defineProperty(r,"__esModule",{value:!0}),r.DatabaseError=r.serialize=r.parse=void 0;var e=F8();Object.defineProperty(r,"DatabaseError",{enumerable:!0,get:w(function(){return e.DatabaseError},"get")});var t=zV();Object.defineProperty(r,"serialize",{enumerable:!0,get:w(function(){return t.serialize},"get")});var n=WV();function i(s,a){let o=new n.Parser;return s.on("data",c=>o.parse(c,a)),new Promise(c=>s.on("end",()=>c()))}w(i,"parse"),r.parse=i}),$8={};vn($8,{connect:()=>U8});VV=Or(()=>{"use strict";ge(),w(U8,"connect")}),z8=Oe((r,e)=>{"use strict";ge();var t=(a0(),Gt(L8)),n=aa(
2025-12-12 13:00:05.69
fe3ac96f
User
/home/runner/workspace/dist/index.cjs:70
2025-12-12 13:00:05.69
fe3ac96f
User
).EventEmitter,{parse:i,serialize:s}=q8(),a=s.flush(),o=s.sync(),c=s.end(),u=class extends n{constructor(d){super(),d=d||{},this.stream=d.stream||new t.Socket,this._keepAlive=d.keepAlive,this._keepAliveInitialDelayMillis=d.keepAliveInitialDelayMillis,this.lastBuffer=!1,this.parsedStatements={},this.ssl=d.ssl||!1,this._ending=!1,this._emitMessage=!1;var h=this;this.on("newListener",function(g){g==="message"&&(h._emitMessage=!0)})}connect(d,h){var g=this;this._connecting=!0,this.stream.setNoDelay(!0),this.stream.connect(d,h),this.stream.once("connect",function(){g._keepAlive&&g.stream.setKeepAlive(!0,g._keepAliveInitialDelayMillis),g.emit("connect")});let f=w(function(y){g._ending&&(y.code==="ECONNRESET"||y.code==="EPIPE")||g.emit("error",y)},"reportStreamError");if(this.stream.on("error",f),this.stream.on("close",function(){g.emit("end")}),!this.ssl)return this.attachListeners(this.stream);this.stream.once("data",function(y){var x=y.toString("utf8");switch(x){case"S":break;case"N":return g.stream.end(),g.emit("error",new Error("The server does not support SSL connections"));default:return g.stream.end(),g.emit("error",new Error("There was an error establishing an SSL connection"))}var _=(VV(),Gt($8));let E={socket:g.stream};g.ssl!==!0&&(Object.assign(E,g.ssl),"key"in g.ssl&&(E.key=g.ssl.key)),t.isIP(h)===0&&(E.servername=h);try{g.stream=_.connect(E)}catch(j){return g.emit("error",j)}g.attachListeners(g.stream),g.stream.on("error",f),g.emit("sslconnect")})}attachListeners(d){d.on("end",()=>{this.emit("end")}),i(d,h=>{var g=h.name==="error"?"errorMessage":h.name;this._emitMessage&&this.emit("message",h),this.emit(g,h)})}requestSsl(){this.stream.write(s.requestSsl())}startup(d){this.stream.write(s.startup(d))}cancel(d,h){this._send(s.cancel(d,h))}password(d){this._send(s.password(d))}sendSASLInitialResponseMessage(d,h){this._send(s.sendSASLInitialResponseMessage(d,h))}sendSCRAMClientFinalMessage(d){this._send(s.sendSCRAMClientFinalMessage(d))}_send(d){return this.stream.writable?this.stream.write(d):!1}query(d){this._send(s.query(d))}parse(d){this._send(s.parse(d))}bind(d){this._send(s.bind(d))}execute(d){this._send(s.execute(d))}flush(){this.stream.writable&&this.stream.write(a)}sync(){this._ending=!0,this._send(a),this._send(o)}ref(){this.stream.ref()}unref(){this.stream.unref()}end(){if(this._ending=!0,!this._connecting||!this.stream.writable){this.stream.end();return}return this.stream.write(c,()=>{this.stream.end()})}close(d){this._send(s.close(d))}describe(d){this._send(s.describe(d))}sendCopyFromChunk(d){this._send(s.copyData(d))}endCopyFrom(){this._send(s.copyDone())}sendCopyFail(d){this._send(s.copyFail(d))}};w(u,"Connection");var l=u;e.exports=l}),HV=Oe((r,e)=>{"use strict";ge();var t=aa().EventEmitter,n=(Uf(),Gt(jl)),i=Wf(),s=RV(),a=LV(),o=n0(),c=s0(),u=$V(),l=Qf(),p=z8(),d=class extends t{constructor(f){super(),this.connectionParameters=new c(f),this.user=this.connectionParameters.user,this.database=this.connectionParameters.database,this.port=this.connectionParameters.port,this.host=this.connectionParameters.host,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:this.connectionParameters.password}),this.replication=this.connectionParameters.replication;var y=f||{};this._Promise=y.Promise||$f.Promise,this._types=new o(y.types),this._ending=!1,this._connecting=!1,this._connected=!1,this._connectionError=!1,this._queryable=!0,this.connection=y.connection||new p({stream:y.stream,ssl:this.connectionParameters.ssl,keepAlive:y.keepAlive||!1,keepAliveInitialDelayMillis:y.keepAliveInitialDelayMillis||0,encoding:this.connectionParameters.client_encoding||"utf8"}),this.queryQueue=[],this.binary=y.binary||l.binary,this.processID=null,this.secretKey=null,this.ssl=this.connectionParameters.ssl||!1,this.ssl&&this.ssl.key&&Object.defineProperty(this.ssl,"key",{enumerable:!1}),this._connectionTimeoutMillis=y.connectionTimeoutMillis||0}_errorAllQueries(f){let y=w(x=>{je.nextTick(()=>{x.handleError(f,this.connection)})},"enqueueError");this.activeQuery&&(y(this.activeQuery),this.activeQuery=null),this.queryQueue.forEach(y),this.queryQueue.length=0}_connect(f){var y=this,x=this.connection;if(this._connectionCallback=f,this._connecting||this._connected){let _=new Error("Client has already been connected. You cannot reuse a client.");je.nextTick(()=>{f(_)});return}this._connecting=!0,this.connectionTimeoutHandle,this._connectionTimeoutMillis>0&&(this.connectionTimeoutHandle=setTimeout(()=>{x._ending=!0,x.stream.destroy(new Error("timeout expired"))},this._connectionTimeoutMillis)),this.host&&this.host.indexOf("/")===0?x.connect(this.host+"/.s.PGSQL."+this.port):x.connect(this.port,this.host),x.on("connect",function(){y.ssl?x.requestSsl():x.startup(y.getStartupConf())}),x.on("sslconnect",function(){x.startup(y.getStartupConf())}),this._attachListeners(x),x.once("end",()=>{let _=this._ending?new Error("Connection terminated"):new Error("Connection terminated unexpectedly");clearTimeout(this.connectionTimeoutHandle),this._errorAllQueries(_),this._ending||(this._connecting&&!this._connectionError?this._connectionCallback?this._connectionCallback(_):this._handleErrorEvent(_):this._connectionError||this._handleErrorEvent(_)),je.nextTick(()=>{this.emit("end")})})}connect(f){if(f){this._connect(f);return}return new this._Promise((y,x)=>{this._connect(_=>{_?x(_):y()})})}_attachListeners(f){f.on("authenticationCleartextPassword",this._handleAuthCleartextPassword.bind(this)),f.on("authenticationMD5Password",this._handleAuthMD5Password.bind(this)),f.on("authenticationSASL",this._handleAuthSASL.bind(this)),f.on("authenticationSASLContinue",this._handleAuthSASLContinue.bind(this)),f.on("authenticationSASLFinal",this._handleAuthSASLFinal.bind(this)),f.on("backendKeyData",this._handleBackendKeyData.bind(this)),f.on("error",this._handleErrorEvent.bind(this)),f.on("errorMessage",this._handleErrorMessage.bind(this)),f.on("readyForQuery",this._handleReadyForQuery.bind(this)),f.on("notice",this._handleNotice.bind(this)),f.on("rowDescription",this._handleRowDescription.bind(this)),f.on("dataRow",this._handleDataRow.bind(this)),f.on("portalSuspended",this._handlePortalSuspended.bind(this)),f.on("emptyQuery",this._handleEmptyQuery.bind(this)),f.on("commandComplete",this._handleCommandComplete.bind(this)),f.on("parseComplete",this._handleParseComplete.bind(this)),f.on("copyInResponse",this._handleCopyInResponse.bind(this)),f.on("copyData",this._handleCopyData.bind(this)),f.on("notification",this._handleNotification.bind(this))}_checkPgPass(f){let y=this.connection;typeof this.password=="function"?this._Promise.resolve().then(()=>this.password()).then(x=>{if(x!==void 0){if(typeof x!="string"){y.emit("error",new TypeError("Password must be a string"));return}this.connectionParameters.password=this.password=x}else this.connectionParameters.password=this.password=null;f()}).catch(x=>{y.emit("error",x)}):this.password!==null?f():a(this.connectionParameters,x=>{x!==void 0&&(this.connectionParameters.password=this.password=x),f()})}_handleAuthCleartextPassword(f){this._checkPgPass(()=>{this.connection.password(this.password)})}_handleAuthMD5Password(f){this._checkPgPass(()=>{let y=i.postgresMd5PasswordHash(this.user,this.password,f.salt);this.connection.password(y)})}_handleAuthSASL(f){this._checkPgPass(()=>{this.saslSession=s.startSession(f.mechanisms),this.connection.sendSASLInitialResponseMessage(this.saslSession.mechanism,this.saslSession.response)})}_handleAuthSASLContinue(f){s.continueSession(this.saslSession,this.password,f.data),this.connection.sendSCRAMClientFinalMessage(this.saslSession.response)}_handleAuthSASLFinal(f){s.finalizeSession(this.saslSession,f.data),this.saslSession=null}_handleBackendKeyData(f){this.processID=f.processID,this.secretKey=f.secretKey}_handleReadyForQuery(f){this._connecting&&(this._connecting=!1,this._connected=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback&&(this._connectionCallback(null,this),this._connectionCallback=null),this.emit("connect"));let{activeQuery:y}=this;this.activeQuery=null,this.readyForQuery=!0,y&&y.handleReadyForQuery(this.connection),this._pulseQueryQueue()}_handleErrorWhileConnecting(f){if(!this._connectionError){if(this._connectionError=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback)return this._connectionCallback(f);this.emit("error",f)}}_handleErrorEvent(f){if(this._connecting)return this._handleErrorWhileConnecting(f);this._queryable=!1,this._errorAllQueries(f),this.emit("error",f)}_handleErrorMessage(f){if(this._connecting)return this._handleErrorWhileConnecting(f);let y=this.activeQuery;if(!y){this._handleErrorEvent(f);return}this.activeQuery=null,y.handleError(f,this.connection)}_handleRowDescription(f){this.activeQuery.handleRowDescription(f)}_handleDataRow(f){this.activeQuery.handleDataRow(f)}_handlePortalSuspended(f){this.activeQuery.handlePortalSuspended(this.connection)}_handleEmptyQuery(f){this.activeQuery.handleEmptyQuery(this.connection)}_handleCommandComplete(f){this.activeQuery.handleCommandComplete(f,this.connection)}_handleParseComplete(f){this.activeQuery.name&&(this.connection.parsedStatements[this.activeQuery.name]=this.activeQuery.text)}_handleCopyInResponse(f){this.activeQuery.handleCopyInResponse(this.connection)}_handleCopyData(f){this.activeQuery.handleCopyData(f,this.connection)}_handleNotification(f){this.emit("notification",f)}_handleNotice(f){this.emit("notice",f)}getStartupConf(){var f=this.connectionParameters,y={user:f.user,database:f.database},x=f.application_name||f.fallback_application_name;return x&&(y.application_name=x),f.replication&&(y.replication=""+f.replication),f.statement_timeout&&(y.statement_timeout=String(parseInt(f.statement_timeout,10))),f.lock_timeout&&(y.lock_timeout=String(parseInt(f.lock_timeout,10))),f.idle_in_transaction_session_timeout&&(y.idle_in_transaction_session_timeout=String(parseInt(f.idle_in_transaction_session_timeout,10))),f.options&&(y.options=f.options),y}cancel(f,y){if(f.activeQuery===y){var x=this.connection;this.host&&this.host.indexOf("/")===0?x.connect(this.host+"/.s.PGSQL."+this.port):x.connect(this.port,this.host),x.on("connect",function(){x.cancel(f.processID,f.secretKey)})}else f.queryQueue.indexOf(y)!==-1&&f.queryQueue.splice(f.queryQueue.indexOf(y),1)}setTypeParser(f,y,x){return this._types.setTypeParser(f,y,x)}getTypeParser(f,y){return this._types.getTypeParser(f,y)}escapeIdentifier(f){return'"'+f.replace(/"/g,'""')+'"'}escapeLiteral(f){for(var y=!1,x="'",_=0;_{this.activeQuery.handleError(f,this.connection),this.readyForQuery=!0,this._pulseQueryQueue()})}else this.hasExecuted&&(this.activeQuery=null,this.emit("drain"))}query(f,y,x){var _,E,j,N,S;if(f==null)throw new TypeError("Client was passed a null or undefined query");return typeof f.submit=="function"?(j=f.query_timeout||this.connectionParameters.query_timeout,E=_=f,typeof y=="function"&&(_.callback=_.callback||y)):(j=this.connectionParameters.query_timeout,_=new u(f,y,x),_.callback||(E=new this._Promise((I,T)=>{_.callback=(A,L)=>A?T(A):I(L)}))),j&&(S=_.callback,N=setTimeout(()=>{var I=new Error("Query read timeout");je.nextTick(()=>{_.handleError(I,this.connection)}),S(I),_.callback=()=>{};var T=this.queryQueue.indexOf(_);T>-1&&this.queryQueue.splice(T,1),this._pulseQueryQueue()},j),_.callback=(I,T)=>{clearTimeout(N),S(I,T)}),this.binary&&!_.binary&&(_.binary=!0),_._result&&!_._result._types&&(_._result._types=this._types),this._queryable?this._ending?(je.nextTick(()=>{_.handleError(new Error("Client was closed and is not queryable"),this.connection)}),E):(this.queryQueue.push(_),this._pulseQueryQueue(),E):(je.nextTick(()=>{_.handleError(new Error("Client has encountered a connection error and is not queryable"),this.connection)}),E)}ref(){this.connection.ref()}unref(){this.connection.unref()}end(f){if(this._ending=!0,!this.connection._connecting)if(f)f();else return this._Promise.resolve();if(this.activeQuery||!this._queryable?this.connection.stream.destroy():this.connection.end(),f)this.connection.once("end",f);else return new this._Promise(y=>{this.connection.once("end",y)})}};w(d,"Client");var h=d;h.Query=u,e.exports=h}),GV=Oe((r,e)=>{"use strict";ge();var t=aa().EventEmitter,n=w(function(){},"NOOP"),i=w((g,f)=>{let y=g.findIndex(f);return y===-1?void 0:g.splice(y,1)[0]},"removeWhere"),s=class{constructor(f,y,x){this.client=f,this.idleListener=y,this.timeoutId=x}};w(s,"IdleItem");var a=s,o=class{constructor(f){this.callback=f}};w(o,"PendingItem");var c=o;function u(){throw new Error("Release called on client which has already been released to the pool.")}w(u,"throwOnDoubleRelease");function l(g,f){if(f)return{callback:f,result:void 0};let y,x,_=w(function(j,N){j?y(j):x(N)},"cb"),E=new g(function(j,N){x=j,y=N}).catch(j=>{throw Error.captureStackTrace(j),j});return{callback:_,result:E}}w(l,"promisify");function p(g,f){return w(function y(x){x.client=f,f.removeListener("error",y),f.on("error",()=>{g.log("additional client error after disconnection due to error",x)}),g._remove(f),g.emit("error",x,f)},"idleListener")}w(p,"makeIdleListener");var d=class extends t{constructor(f,y){super(),this.options=Object.assign({},f),f!=null&&"password"in f&&Object.defineProperty(this.options,"password",{configurable:!0,enumerable:!1,writable:!0,value:f.password}),f!=null&&f.ssl&&f.ssl.key&&Object.defineProperty(this.options.ssl,"key",{enumerable:!1}),this.options.max=this.options.max||this.options.poolSize||10,this.options.maxUses=this.options.maxUses||1/0,this.options.allowExitOnIdle=this.options.allowExitOnIdle||!1,this.options.maxLifetimeSeconds=this.options.maxLifetimeSeconds||0,this.log=this.options.log||function(){},this.Client=this.options.Client||y||o0().Client,this.Promise=this.options.Promise||$f.Promise,typeof this.options.idleTimeoutMillis>"u"&&(this.options.idleTimeoutMillis=1e4),this._clients=[],this._idle=[],this._expired=new WeakSet,this._pendingQueue=[],this._endCallback=void 0,this.ending=!1,this.ended=!1}_isFull(){return this._clients.length>=this.options.max}_pulseQueue(){if(this.log("pulse queue"),this.ended){this.log("pulse queue ended");return}if(this.ending){this.log("pulse queue on ending"),this._idle.length&&this._idle.slice().map(y=>{this._remove(y.client)}),this._clients.length||(this.ended=!0,this._endCallback());return}if(!this._pendingQueue.length){this.log("no queued requests");return}if(!this._idle.length&&this._isFull())return;let f=this._pendingQueue.shift();if(this._idle.length){let y=this._idle.pop();clearTimeout(y.timeoutId);let x=y.client;x.ref&&x.ref();let _=y.idleListener;return this._acquireClient(x,f,_,!1)}if(!this._isFull())return this.newClient(f);throw new Error("unexpected condition")}_remove(f){let y=i(this._idle,x=>x.client===f);y!==void 0&&clearTimeout(y.timeoutId),this._clients=this._clients.filter(x=>x!==f),f.end(),this.emit("remove",f)}connect(f){if(this.ending){let _=new Error("Cannot use a pool after calling end on the pool");return f?f(_):this.Promise.reject(_)}let y=l(this.Promise,f),x=y.result;if(this._isFull()||this._idle.length){if(this._idle.length&&je.nextTick(()=>this._pulseQueue()),!this.options.connectionTimeoutMillis)return this._pendingQueue.push(new c(y.callback)),x;let _=w((N,S,I)=>{clearTimeout(j),y.callback(N,S,I)},"queueCallback"),E=new c(_),j=setTimeout(()=>{i(this._pendingQueue,N=>N.callback===_),E.timedOut=!0,y.callback(new Error("timeout exceeded when trying to connect"))},this.options.connectionTimeoutMillis);return this._pendingQueue.push(E),x}return this.newClient(new c(y.callback)),x}newClient(f){let y=new this.Client(this.options);this._clients.push(y);let x=p(this,y);this.log("checking client timeout");let _,E=!1;this.options.connectionTimeoutMillis&&(_=setTimeout(()=>{this.log("ending client due to timeout"),E=!0,y.connection?y.connection.stream.destroy():y.end()},this.options.connectionTimeoutMillis)),this.log("connecting new client"),y.connect(j=>{if(_&&clearTimeout(_),y.on("error",x),j)this.log("client failed to connect",j),this._clients=this._clients.filter(N=>N!==y),E&&(j.message="Connection terminated due to connection timeout"),this._pulseQueue(),f.timedOut||f.callback(j,void 0,n);else{if(this.log("new client connected"),this.options.maxLifetimeSeconds!==0){let N=setTimeout(()=>{this.log("ending client due to expired lifetime"),this._expired.add(y),this._idle.findIndex(S=>S.client===y)!==-1&&this._acquireClient(y,new c((S,I,T)=>T()),x,!1)},this.options.maxLifetimeSeconds*1e3);N.unref(),y.once("end",()=>clearTimeout(N))}return this._acquireClient(y,f,x,!0)}})}_acquireClient(f,y,x,_){_&&this.emit("connect",f),this.emit("acquire",f),f.release=this._releaseOnce(f,x),f.removeListener("error",x),y.timedOut?_&&this.options.verify?this.options.verify(f,f.release):f.release():_&&this.options.verify?this.options.verify(f,E=>{if(E)return f.release(E),y.callback(E,void 0,n);y.callback(void 0,f,f.release)}):y.callback(void 0,f,f.release)}_releaseOnce(f,y){let x=!1;return _=>{x&&u(),x=!0,this._release(f,y,_)}}_release(f,y,x){if(f.on("error",y),f._poolUseCount=(f._poolUseCount||0)+1,this.emit("release",x,f),x||this.ending||!f._queryable||f._ending||f._poolUseCount>=this.options.maxUses){f._poolUseCount>=this.options.maxUses&&this.log("remove expended client"),this._remove(f),this._pulseQueue();return}if(this._expired.has(f)){this.log("remove expired client"),this._expired.delete(f),this._remove(f),this._pulseQueue();return}let _;this.options.idleTimeoutMillis&&(_=setTimeout(()=>{this.log("remove idle client"),this._remove(f)},this.options.idleTimeoutMillis),this.options.allowExitOnIdle&&_.unref()),this.options.allowExitOnIdle&&f.unref(),this._idle.push(new a(f,y,_)),this._pulseQueue()}query(f,y,x){if(typeof f=="function"){let E=l(this.Promise,f);return Zx(function(){return E.callback(new Error("Passing a function as the first parameter to pool.query is not supported"))}),E.result}typeof y=="function"&&(x=y,y=void 0);let _=l(this.Promise,x);return x=_.callback,this.connect((E,j)=>{if(E)return x(E);let N=!1,S=w(I=>{N||(N=!0,j.release(I),x(I))},"onError");j.once("error",S),this.log("dispatching query");try{j.query(f,y,(I,T)=>{if(this.log("query dispatched"),j.removeListener("error",S),!N)return N=!0,j.release(I),I?x(I):x(void 0,T)})}catch(I){return j.release(I),x(I)}}),_.result}end(f){if(this.log("ending"),this.ending){let x=new Error("Called end on pool more than once");return f?f(x):this.Promise.reject(x)}this.ending=!0;let y=l(this.Promise,f);return this._endCallback=y.callback,this._pulseQueue(),y.result}get waitingCount(){return this._pendingQueue.length}get idleCount(){return this._idle.length}get expiredCount(){return this._clients.reduce((f,y)=>f+(this._expired.has(y)?1:0),0)}get totalCount(){return this._clients.length}};w(d,"Pool");var h=d;e.exports=h}),Q8={};vn(Q8,{default:()=>W8});KV=Or(()=>{"use strict";ge(),W8={}}),JV=Oe((r,e)=>{e.exports={name:"pg",version:"8.8.0",description:"PostgreSQL client - pure javascript & libpq with the same API",keywords:["database","libpq","pg","postgre","postgres","postgresql","rdbms"],homepage:"https://github.com/brianc/node-postgres",repository:{type:"git",url:"git://github.com/brianc/node-postgres.git",directory:"packages/pg"},author:"Brian Carlson ",main:"./lib",dependencies:{"buffer-writer":"2.0.0","packet-reader":"1.0.0","pg-connection-string":"^2.5.0","pg-pool":"^3.5.2","pg-protocol":"^1.5.0","pg-types":"^2.1.0",pgpass:"1.x"},devDependencies:{async:"2.6.4",bluebird:"3.5.2",co:"4.6.0","pg-copy-streams":"0.3.0"},peerDependencies:{"pg-native":">=3.0.1"},peerDependenciesMeta:{"pg-native":{optional:!0}},scripts:{test:"make test-all"},files:["lib","SPONSORS.md"],license:"MIT",engines:{node:">= 8.0.0"},gitHead:"c99fb2c127ddf8d712500db2c7b9a5491a178655"}}),XV=Oe((r,e)=>{"use strict";ge();var t=aa().EventEmitter,n=(Uf(),Gt(jl)),i=Wf(),s=e.exports=function(o,c,u){t.call(this),o=i.normalizeQueryConfig(o,c,u),this.text=o.text,this.values=o.values,this.name=o.name,this.callback=o.callback,this.state="new",this._arrayMode=o.rowMode==="array",this._emitRowEvents=!1,this.on("newListener",function(l){l==="row"&&(this._emitRowEvents=!0)}.bind(this))};n.inherits(s,t);var a={sqlState:"code",statementPosition:"position",messagePrimary:"message",context:"where",schemaName:"schema",tableName:"table",columnName:"column",dataTypeName:"dataType",constraintName:"constraint",sourceFile:"file",sourceLine:"line",sourceFunction:"routine"};s.prototype.handleError=function(o){var c=this.native.pq.resultErrorFields();if(c)for(var u in c){var l=a[u]||u;o[l]=c[u]}this.callback?this.callback(o):this.emit("error",o),this.state="error"},s.prototype.then=function(o,c){return this._getPromise().then(o,c)},s.prototype.catch=function(o){return this._getPromise().catch(o)},s.prototype._getPromise=function(){return this._promise?this._promise:(this._promise=new Promise(function(o,c){this._once("end",o),this._once("error",c)}.bind(this)),this._promise)},s.prototype.submit=function(o){this.state="running";var c=this;this.native=o.native,o.native.arrayMode=this._arrayMode;var u=w(function(d,h,g){if(o.native.arrayMode=!1,Zx(function(){c.emit("_done")}),d)return c.handleError(d);c._emitRowEvents&&(g.length>1?h.forEach((f,y)=>{f.forEach(x=>{c.emit("row",x,g[y])})}):h.forEach(function(f){c.emit("row",f,g)})),c.state="end",c.emit("end",g),c.callback&&c.callback(null,g)},"after");if(je.domain&&(u=je.domain.bind(u)),this.name){this.name.length>63&&(console.error("Warning! Postgres only supports 63 characters for query names."),console.error("You supplied %s (%s)",this.name,this.name.length),console.error("This can cause conflicts and silent errors executing queries"));var l=(this.values||[]).map(i.prepareValue);if(o.namedQueries[this.name]){if(this.text&&o.namedQueries[this.name]!==this.text){let d=new Error(`Prepared statements must be unique - '${this.name}' was used for a different statement`);return u(d)}return o.native.execute(this.name,l,u)}return o.native.prepare(this.name,this.text,l.length,function(d){return d?u(d):(o.namedQueries[c.name]=c.text,c.native.execute(c.name,l,u))})}else if(this.values){if(!Array.isArray(this.values)){let d=new Error("Query values must be an array");return u(d)}var p=this.values.map(i.prepareValue);o.native.query(this.text,p,u)}else o.native.query(this.text,u)}}),ZV=Oe((r,e)=>{"use strict";ge();var t=(KV(),Gt(Q8)),n=n0(),i=JV(),s=aa().EventEmitter,a=(Uf(),Gt(jl)),o=s0(),c=XV(),u=e.exports=function(l){s.call(this),l=l||{},this._Promise=l.Promise||$f.Promise,this._types=new n(l.types),this.native=new t({types:this._types}),this._queryQueue=[],this._ending=!1,this._connecting=!1,this._connected=!1,this._queryable=!0;var p=this.connectionParameters=new o(l);this.user=p.user,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:p.password}),this.database=p.database,this.host=p.host,this.port=p.port,this.namedQueries={}};u.Query=c,a.inherits(u,s),u.prototype._errorAllQueries=function(l){let p=w(d=>{je.nextTick(()=>{d.native=this.native,d.handleError(l)})},"enqueueError");this._hasActiveQuery()&&(p(this._activeQuery),this._activeQuery=null),this._queryQueue.forEach(p),this._queryQueue.length=0},u.prototype._connect=function(l){var p=this;if(this._connecting){je.nextTick(()=>l(new Error("Client has already been connected. You cannot reuse a client.")));return}this._connecting=!0,this.connectionParameters.getLibpqConnectionString(function(d,h){if(d)return l(d);p.native.connect(h,function(g){if(g)return p.native.end(),l(g);p._connected=!0,p.native.on("error",function(f){p._queryable=!1,p._errorAllQueries(f),p.emit("error",f)}),p.native.on("notification",function(f){p.emit("notification",{channel:f.relname,payload:f.extra})}),p.emit("connect"),p._pulseQueryQueue(!0),l()})})},u.prototype.connect=function(l){if(l){this._connect(l);return}return new this._Promise((p,d)=>{this._connect(h=>{h?d(h):p()})})},u.prototype.query=function(l,p,d){var h,g,f,y,x;if(l==null)throw new TypeError("Client was passed a null or undefined query");if(typeof l.submit=="function")f=l.query_timeout||this.connectionParameters.query_timeout,g=h=l,typeof p=="function"&&(l.callback=p);else if(f=this.connectionParameters.query_timeout,h=new c(l,p,d),!h.callback){let _,E;g=new this._Promise((j,N)=>{_=j,E=N}),h.callback=(j,N)=>j?E(j):_(N)}return f&&(x=h.callback,y=setTimeout(()=>{var _=new Error("Query read timeout");je.nextTick(()=>{h.handleError(_,this.connection)}),x(_),h.callback=()=>{};var E=this._queryQueue.indexOf(h);E>-1&&this._queryQueue.splice(E,1),this._pulseQueryQueue()},f),h.callback=(_,E)=>{clearTimeout(y),x(_,E)}),this._queryable?this._ending?(h.native=this.native,je.nextTick(()=>{h.handleError(new Error("Client was closed and is not queryable"))}),g):(this._queryQueue.push(h),this._pulseQueryQueue(),g):(h.native=this.native,je.nextTick(()=>{h.handleError(new Error("Client has encountered a connection error and is not queryable"))}),g)},u.prototype.end=function(l){var p=this;this._ending=!0,this._connected||this.once("connect",this.end.bind(this,l));var d;return l||(d=new this._Promise(function(h,g){l=w(f=>f?g(f):h(),"cb")})),this.native.end(function(){p._errorAllQueries(new Error("Connection terminated")),je.nextTick(()=>{p.emit("end"),l&&l()})}),d},u.prototype._hasActiveQuery=function(){return this._activeQuery&&this._activeQuery.state!=="error"&&this._activeQuery.state!=="end"},u.prototype._pulseQueryQueue=function(l){if(this._connected&&!this._hasActiveQuery()){var p=this._queryQueue.shift();if(!p){l||this.emit("drain");return}this._activeQuery=p,p.submit(this);var d=this;p.once("_done",function(){d._pulseQueryQueue()})}},u.prototype.cancel=function(l){this._activeQuery===l?this.native.cancel(function(){}):this._queryQueue.indexOf(l)!==-1&&this._queryQueue.splice(this._queryQueue.indexOf(l),1)},u.prototype.ref=function(){},u.prototype.unref=function(){},u.prototype.setTypeParser=function(l,p,d){return this._types.setTypeParser(l,p,d)},u.prototype.getTypeParser=function(l,p){return this._types.getTypeParser(l,p)}}),m8=Oe((r,e)=>{"use strict";ge(),e.exports=ZV()}),o0=Oe((r,e)=>{"use strict";ge();var t=HV(),n=Qf(),i=z8(),s=GV(),{DatabaseError:a}=q8(),o=w(u=>{var l;return l=class extends s{constructor(p){super(p,u)}},w(l,"BoundPool"),l},"poolFactory"),c=w(function(u){this.defaults=n,this.Client=u,this.Query=this.Client.Query,this.Pool=o(this.Client),this._pools=[],this.Connection=i,this.types=zf(),this.DatabaseError=a},"PG");typeof je.env.NODE_PG_FORCE_NATIVE<"u"?e.exports=new c(m8()):(e.exports=new c(t),Object.defineProperty(e.exports,"native",{configurable:!0,enumerable:!1,get(){var u=null;try{u=new c(m8())}catch(l){if(l.code!=="MODULE_NOT_FOUND")throw l}return Object.defineProperty(e.exports,"native",{value:u}),u}}))});ge();V8=Uo(o0());a0();ge();a0();M8();YV=Uo(Wf()),eH=Uo(n0());w(H8,"encodeBuffersAsBytea");G8=class K8 extends Error{constructor(e){super(e),Ae(this,"name","NeonDbError"),Ae(this,"severity"),Ae(this,"code"),Ae(this,"detail"),Ae(this,"hint"),Ae(this,"position"),Ae(this,"internalPosition"),Ae(this,"internalQuery"),Ae(this,"where"),Ae(this,"schema"),Ae(this,"table"),Ae(this,"column"),Ae(this,"dataType"),Ae(this,"constraint"),Ae(this,"file"),Ae(this,"line"),Ae(this,"routine"),Ae(this,"sourceError"),"captureStackTrace"in Error&&typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,K8)}};w(G8,"NeonDbError");qo=G8,h8="transaction() expects an array of queries, or a function returning an array of queries",tH=["severity","code","detail","hint","position","internalPosition","internalQuery","where","schema","table","column","dataType","constraint","file","line","routine"];w(J8,"neon");w(X8,"createNeonQueryPromise");w(Xx,"processQueryResult");w(Z8,"getAuthToken");rH=Uo(s0()),zo=Uo(o0()),Y8=class extends V8.Client{constructor(e){super(e),this.config=e}get neonConfig(){return this.connection.stream}connect(e){let{neonConfig:t}=this;t.forceDisablePgSSL&&(this.ssl=this.connection.ssl=!1),this.ssl&&t.useSecureWebSocket&&console.warn("SSL is enabled for both Postgres (e.g. ?sslmode=require in the connection string + forceDisablePgSSL = false) and the WebSocket tunnel (useSecureWebSocket = true). Double encryption will increase latency and CPU usage. It may be appropriate to disable SSL in the Postgres connection parameters or set forceDisablePgSSL = true.");let n=this.config?.host!==void 0||this.config?.connectionString!==void 0||je.env.PGHOST!==void 0,i=je.env.USER??je.env.USERNAME;if(!n&&this.host==="localhost"&&this.user===i&&this.database===i&&this.password===null)throw new Error(`No database host or connection string was set, and key parameters have default values (host: localhost, user: ${i}, db: ${i}, password: null). Is an environment variable missing? Alternatively, if you intended to connect with these parameters, please set the host to 'localhost' explicitly.`);let s=super.connect(e),a=t.pipelineTLS&&this.ssl,o=t.pipelineConnect==="password";if(!a&&!t.pipelineConnect)return s;let c=this.connection;if(a&&c.on("connect",()=>c.stream.emit("data","S")),o){c.removeAllListeners("authenticationCleartextPassword"),c.removeAllListeners("readyForQuery"),c.once("readyForQuery",()=>c.on("readyForQuery",this._handleReadyForQuery.bind(this)));let u=this.ssl?"sslconnect":"connect";c.on(u,()=>{this._handleAuthCleartextPassword(),this._handleReadyForQuery()})}return s}async _handleAuthSASLContinue(e){let t=this.saslSession,n=this.password,i=e.data;if(t.message!=="SASLInitialResponse"||typeof n!="string"||typeof i!="string")throw new Error("SASL: protocol error");let s=Object.fromEntries(i.split(",").map(ve=>{if(!/^.=/.test(ve))throw new Error("SASL: Invalid attribute pair entry");let Re=ve[0],Be=ve.substring(2);return[Re,Be]})),a=s.r,o=s.s,c=s.i;if(!a||!/^[!-+--~]+$/.test(a))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: nonce missing/unprintable");if(!o||!/^(?:[a-zA-Z0-9+/]{4})*(?:[a-zA-Z0-9+/]{2}==|[a-zA-Z0-9+/]{3}=)?$/.test(o))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: salt missing/not base64");if(!c||!/^[1-9][0-9]*$/.test(c))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: missing/invalid iteration count");if(!a.startsWith(t.clientNonce))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce does not start with client nonce");if(a.length===t.clientNonce.length)throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce is too short");let u=parseInt(c,10),l=Ce.from(o,"base64"),p=new TextEncoder,d=p.encode(n),h=await fr.subtle.importKey("raw",d,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),g=new Uint8Array(await fr.subtle.sign("HMAC",h,Ce.concat([l,Ce.from([0,0,0,1])]))),f=g;for(var y=0;yf[Re]^g[Re]));let x=f,_=await fr.subtle.importKey("raw",x,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),E=new Uint8Array(await fr.subtle.sign("HMAC",_,p.encode("Client Key"))),j=await fr.subtle.digest("SHA-256",E),N="n=*,r="+t.clientNonce,S="r="+a+",s="+o+",i="+u,I="c=biws,r="+a,T=N+","+S+","+I,A=await fr.subtle.importKey("raw",j,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]);var L=new Uint8Array(await fr.subtle.sign("HMAC",A,p.encode(T))),B=Ce.from(E.map((ve,Re)=>E[Re]^L[Re])),ee=B.toString("base64");let X=await fr.subtle.importKey("raw",x,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),F=await fr.subtle.sign("HMAC",X,p.encode("Server Key")),G=await fr.subtle.importKey("raw",F,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]);var ue=Ce.from(await fr.subtle.sign("HMAC",G,p.encode(T)));t.message="SASLResponse",t.serverSignature=ue.toString("base64"),t.response=I+",p="+ee,this.connection.sendSCRAMClientFinalMessage(this.saslSession.response)}};w(Y8,"NeonClient");nH=Y8;w(e6,"promisify");t6=class extends V8.Pool{constructor(){super(...arguments),Ae(this,"Client",nH),Ae(this,"hasFetchUnsupportedListeners",!1)}on(e,t){return e!=="error"&&(this.hasFetchUnsupportedListeners=!0),super.on(e,t)}query(e,t,n){if(!Yi.poolQueryViaFetch||this.hasFetchUnsupportedListeners||typeof e=="function")return super.query(e,t,n);typeof t=="function"&&(n=t,t=void 0);let i=e6(this.Promise,n);n=i.callback;try{let s=new rH.default(this.options),a=encodeURIComponent,o=encodeURI,c=`postgresql://${a(s.user)}:${a(s.password)}@${a(s.host)}/${o(s.database)}`,u=typeof e=="string"?e:e.text,l=t??e.values??[];J8(c,{fullResults:!0,arrayMode:e.rowMode==="array"})(u,l,{types:e.types??this.
2025-12-12 13:00:05.72
fe3ac96f
User
npm notice
2025-12-12 13:00:05.72
fe3ac96f
User
npm notice Changelog: https://github.com/npm/cli/releases/tag/v11.7.0
2025-12-12 13:00:05.72
fe3ac96f
User
npm notice
2025-12-12 13:00:05.72
fe3ac96f
User
npm notice To update run: npm install -g npm@11.7.0
2025-12-12 13:00:05.72
fe3ac96f
User
npm notice New major version of npm available! 10.8.2 -> 11.7.0
2025-12-12 13:00:05.74
fe3ac96f
System
command finished with error [npm run start]: exit status 1